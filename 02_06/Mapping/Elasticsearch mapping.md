# Elasticsearch Mapping
- Mapping
    - 관계형 데이터베이스의 스키마와 유사한 개념
    - Elasticsearch에서 문서(Document)의 필드 유형과 속성을 정의

- 동적 매핑(Dynamic Mapping)
    - 매핑을 명시적으로 설정하지 않아도 Elasticsearch가 자동으로 생성
    - 편리하지만, 잘못된 데이터 타입 할당 가능성이 있음

- 정적 매핑(Explicit Mapping)
    - 사전에 명확하게 매핑을 정의하여 정확한 데이터 타입을 설정
    - 검색 성능 최적화 및 불필요한 리소스 낭비 방지 가능


# Dynamic Mapping
## Mapping
    - Elasticsearch에서 문서를 색인할 때 필드 이름과 데이터 유형을 자동으로 결정하는 기능
    - 관계형 데이터베이스의 스키마와 유사한 개념이지만, 사전 정의 없이도 데이터 유형이 결정
    - 자동매핑
        - 필드를 사전에 정의하지 않아도 문서를 색인하면 자동으로 매핑
    - 규칙 설정 가능
        - 동적 필드 매핑 규칙을 사용하여 원하는 방식으로 동작하도록 설정 가능
    - 데이터 유형 결정
        - 새로운 필드가 감지되면 해당 필드의 데이터 유형을 자동으로 판단하여 매핑
    - 오류 가능성
        - 자동으로 할당된 데이터 유형이 잘못될 경우 검색 오류 발생 가능
    - 파라미터 설정 가능
        - 동적 매핑을 활성화하거나 비활성화하는 설정을 조정 가능

# Static Mapping
- 정적 매핑은 문서에 저장될 데이터의 필드와 타입을 사전에 정의하는 방식
- 인덱스 생성 시점에 필드 타입을 미리 지정해야 하며, 한 번 설정된 매핑은 일부 변경이 제한

# Elasticsearch 필드 데이터 타입
- 지형 데이터 타입(Geo Data Types)
    - geo_point, geo_shape
- 게층 구조 데이터 타입(Hierarchical Data Types)
    - Object, Nested
- 일반 데이터 타입
    - 문자열 데이터 타입 : keyword, text
    - date,
    - long, double, integer
    - boolean..

## 문자열 데이터 타입
    - text
        - 전문(full-text) 검색을 위한 분석(토큰화)이 적용된 문자열
    - keyword
        - 정렬 및 필터링에 최적화된 문자열
    - 공간을 절약하고 쓰기 속도를 높이기 위해 색인 전 매핑을 설정하는 것이 유리

## Keyword 필드 타입
- 데이터 변형 없이 저장 -> 분석기(analyzer)를 적용하지 않음
- 공백과 대소문자를 구분하지 않음 -> 정확한 검색 수행
- 집계, 정렬, 필터링 등에 적합
- keyword, constant_keyword, wildcard 등의 타입으로 설정 가능
- 정확한 값으로 검색해야 하는 항목
    - 태그(tags),카테고리(category)
- 정렬이 필요한 데이터
    - 브랜드명(brand), 사용자 ID(user_id)
- 집계(Aggregation)이 필요한 데이터
    - 로그수준(log_level), 국가 코드(country_code)
- constant_keyword 필드 타입
    - 색인 크기를 줄이고 검색 속도를 높임
    - 필터링(Querying)성능 최적화에 적합
    - 수정 불가능


## Text 필드 타입
- 입력된 텍스트를 분석기(Analyzer)를 사용해 토큰으로 분리
- 부분 검색 가능 -> 입력된 단어의 일부만 일치해도 검색 결과에 포함됨
- 공백,대소문자,형태소 분석 등 다양한 처리가 가능
- 정확한 검색보다는 문서 검색과 연관성 기반 검색에 적합
    - match_only_text 필드 타입
        - 로그 분석 시 주로 사용
        - keyword 필드와 text 필드의 중간 단계
        - 전체 텍스트 쿼리를 실행하며 점수를 매기지 않음
        - 정렬이나 집계가 필요 없을 경우 적합
    
    - search_as_you_type 필드 타입
        - 자동완성 검색을 지원하는 데이터 타입
        - n-gram 분석기를 사용하여 전방 일치 또는 중간 일치 검색 가능
        - 검색 시 입력이 점진적으로 확장되는 형태의 검색을 지원
        - 매핑에 지정된 분석기 사용 / 별도 분석기가 없으면 기본 분석기 사용


