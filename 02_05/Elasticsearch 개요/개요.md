# 정보 검색
- 대규모 데이터 속에서 사용자가 원하는 정보를 찾아 제공하는 기술
- 웹 문서, 이미지, 동영상, 연구 논문 등 다양한 데이터 유형을 대상으로 함
- Google, Microsoft 등 글로벌 기업에서 핵심적 활용
- 검색 시스템에서의 요구사항
    - 빠르고 정확한 검색 결과
    - 사용자 경험
    - 보안 및 개인 정보
    - 확장성 및 유지보수

# 정보 검색의 핵심 기술
- 데이터 수집
    - 웹 크롤링 : 웹 문서를 자동으로 수집하여 색인하는 방식
    - 스크래핑 : 특정 웹사이트에서 데이터를 추출하여 가공하는 방식
- 데이터 저장 - 역색인
    - 키워드와 해당 키워드가 포함된 문서 정보를 저장하는 구조
    - 문서 검색 시 키워드를 기반으로 관련 문서를 빠르게 찾아줌
- 검색 알고리즘
    - TF-IDF : 특정 키워드가 문서 내에서 가지는 상대적 중요도를 평가하는 기법
    - BM25 :TF-IDF를 개선한 가중치 기반 검색 알고리즘으로, 검색 정확도를 높임

# 기존 RDB 검색
- 삼성 블루투스 이어폰 이라는 타이틀을 검색한다는 가정
    - SQL : SELECT title FROM product WHERE title LIKE '%삼성 블루투스 이어폰%'
- 문제점
    - 쿼리가 복잡
    - 성능에 문제 발생(대량 데이터에서 LIKE 연산 비효율)
    - 스펠링 오류, 유사 검색 불가

# Elasticsearch
- 강력한 오픈소스 검색 및 분석 엔진
- 수평적 확장성, 안정성, 쉬운 관리를 위한 설게
- Apache Lucene 기반, Elastic Stack의 일부로 Logstash, Beats, Kibana를 포함

# Elasticsearch와 Lucene의 관계
- Elasticsearch
    - 분산 검색 엔진, 데이터를 저장하고 빠르게 검색
    - Lucene을 내부 엔진으로 사용
- Lucene
    - 검색 라이브러리, Elasticsearch의 핵심 검색 기능 담당
    - Java로 작성된 고성능 텍스트 검색 엔진 라이브러리
    - 검색, 색인 기능을 제공
    - 단독으로 사용하려면 직접 애플리케이션 개발 필요
- Elasticsearch는 Lucene을 기반으로 동작하며 REST API 및 분산 환경 지원


# Lucene란
- 검색용 서비스의 핵심 : 루씬
    - Elasticsearch에서의 검색관련 API의 대부분은 루씬 기반의 검색 API에서 출발
    - 분산처리, 캐싱, 샤드 기반 검색 등의 추가 기능을 제공하여 대규모 데이터 검색을 최적화

# Lucene의 segment
- 세그먼트란
    - Luceneㅇ서 색인된 문서들을 저장하는 최소 단위
    - 하나의 샤드는 여러 개의 세그먼트로 구성
    - 세그먼트는 한 번 생성되면 수정 안됨(immutable)
        - 문서가 업데이트되면 새로운 세그먼트가 생성
        - 삭제된 문서는 "삭제 플래그"로 관리
- 장점
    - 동시성확보 : 여러 세그먼트에서 동시 검색 가능
    - 빠른 색인 처리 : 기존 세그먼트를 수정하지 않고 새로운 세그먼트 추가
    - 안정적인 검색 : 검색 시 기존 세그먼트는 그대로 유지되므로, 검색 중단 없이 색인 가능

# Elasticsearch 특징
- 분산 구조
    - 클러스터 내 사용 가능한 모든 노드에 데이터를 자동으로 분산하여 준실시간으로 대량의 데이터를 처리 가능하도록 함
- 전문 검색
    - 고급 전문 검색 기능을 지원, HTTP 웹 인터페이스와 스키마가 없는 JSON 문서 사용
- 확장성
    - 수백 대에서 수천 대의 서버로 확장 가능, 구조화된 데이터 및 비정형 데이터 수 페타바이트 규모까지 처리 가능
- 유연성
    - 다양한 소스로부터의 이질적인 데이터 유형을 색인할 수 있으며, 복잡한 검색 기능 제공

# Elasticsearch 활용
- 기업검색
    - 기업에서 전체 디지털 콘텐츠를 색인하여 내부 네트워크 또는 웹사이트에서 고급 검색 기능을 제공하는 데 활용
- 로그 수집 및 분석
    - Logstash 및 Kibana와 함께 사용하여 로그 데이터를 분석하고 IT 운영, 보안, 성능 모니터링에 대한 인사이트 제공
- 보안 정보 및 이벤트 관리
    - 조직에서 보안 데이터를 실시간으로 분석하고 시각화하여 위협 감지 및 규정 준수 관리에 활용
- 데이터 분석
    - 빅데이터 분석을 위해 사용되며, 대량 데이터를 빠르고 다양한 방식으로 탐색할 수 있도록 지원
- 개인화 및 추천 시스템
    - 이커머스 웹사이트 등에서 사용자의 행동과 상호작용을 분석하여 맞춤형 상품 추천 및 동적 콘텐츠 제공에 활용

# # Elasticsearch 기본 요소
- 문서
    - 문서는 색인될 수 있는 기본 정보 단위
    - 각 문서는 JSON 형식으로 표현되며, 가벼운 데이터 교환 형식
- 필드
    - 가장 작은 데이터 단위, 키-값 쌍을 의미

# Elasticsearch 데이터 저장 및 관리
- 인덱싱
    - 데이터를 index 단위로 관리
    - 각 인덱스는 DB처럼 동작
    - 문서는 JSON 형식 저장, 검색을 위해 최적화된 형태로 변환
- 샤딩
    - index는 여러 개의 샤드로 나눌 수 있음
    - 데이터를 여러 노드에 분산 저장하여 성능을 향상, 대용량 데이터와 높은 검색 요청을 효과적으로 처리
- 레플리카
    - 기본 샤드의 사본 , 장애 발생 시 데이터 손실을 방지하고 검색 성능을 향상시키는 역할
    - 여러 복제본이 존재하면 검색 요청을 분산 처리할 수 있어 시스템의 안정성과 확장성이 높아짐

# Elasticsearch 검색 동작 원리
- 질의 처리
    - 사용자가 질의를 입력하면, 해당 질의는 구문 분석 및 변환 과정을 거쳐 Lucene 인덱스에서 검색이 가능하도록 최적화된 형식으로 변환
    - 변환된 질의는 모든 관련 샤드에 병렬로 실행되어 빠른 검색이 가능

- 연관성 점수 계산
    - 검색 결과의 연관성을 평가하기 위해 다양한 알고리즘을 활용
    - TF-IDF 및 BM25 등의 알고리즘을 사용하여 각 문서가 사용자의 질의와 부합하는지 계산
    - 해당 점수는 검색 결과의 순위를 결정하는데 활용

- 준실시간 검색
    - 데이터를 검색하면서 동시에 색인 할 수 있는 준실시간 검색 기능을 제공
    - 메모리 버퍼를 활용해 새로운 문서를 저장
    - 일정 주기로 버퍼를 비워 색인 세그먼트를 생성하여 빠르게 검색 가능

- 준실시간 검색이 가능한 이유
    - 메모리 기반 버퍼링으로 색인 속도 향상
    - 비동기 색인 처리로 검색과 색인을 동시에 수행
    - Lucene 엔진 최적화를 통한 빠른 색인 적용

# 그 밖의 특징
- 유연한 JSON 데이터 관리
- 정밀한 검색 및 필터링
- 다양한 검색 쿼리 지원
- 다양한 클라이언트 지원
- 확장성과 안정성
- Kibana 데이터 시각화

